<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QS Empire - Eng. Basel Omar</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --gray: #64748b;
            --light: #f1f5f9;
            --white: #ffffff;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
            color: var(--white);
        }
        
        /* Sidebar */
        .sidebar {
            position: fixed;
            right: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            border-left: 1px solid rgba(255,255,255,0.1);
            padding: 20px;
            z-index: 100;
            transition: transform 0.3s ease;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .logo-text h2 {
            font-size: 18px;
            font-weight: 700;
        }
        
        .logo-text span {
            font-size: 12px;
            color: var(--gray);
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 5px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border-radius: 10px;
            color: var(--gray);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .nav-link:hover, .nav-link.active {
            background: rgba(37, 99, 235, 0.2);
            color: var(--white);
        }
        
        .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        }
        
        .nav-link i {
            width: 24px;
            font-size: 18px;
        }
        
        /* Main Content */
        .main-content {
            margin-right: 280px;
            padding: 30px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            border: none;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(37, 99, 235, 0.3);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--secondary), #059669);
            color: white;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .stat-icon.blue { background: rgba(37, 99, 235, 0.2); color: var(--primary); }
        .stat-icon.green { background: rgba(16, 185, 129, 0.2); color: var(--secondary); }
        .stat-icon.yellow { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .stat-icon.red { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 14px;
        }
        
        .stat-change {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 20px;
        }
        
        .stat-change.up { background: rgba(16, 185, 129, 0.2); color: var(--secondary); }
        .stat-change.down { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        
        /* Cards */
        .card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 700;
        }
        
        /* Tables */
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 14px;
            text-align: right;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        th {
            color: var(--gray);
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
        }
        
        tr:hover {
            background: rgba(255,255,255,0.02);
        }
        
        /* Status Badges */
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-new { background: rgba(37, 99, 235, 0.2); color: var(--primary); }
        .badge-pending { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .badge-won { background: rgba(16, 185, 129, 0.2); color: var(--secondary); }
        .badge-lost { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--gray);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.05);
            color: white;
            font-family: 'Cairo', sans-serif;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
        }
        
        select.form-control {
            cursor: pointer;
        }
        
        /* Grid layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        /* Page sections */
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* Opportunity Cards */
        .opp-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .opp-card:hover {
            border-color: var(--primary);
            transform: translateX(-5px);
        }
        
        .opp-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }
        
        .opp-title {
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .opp-platform {
            font-size: 12px;
            color: var(--gray);
        }
        
        .opp-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }
        
        .opp-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: var(--gray);
        }
        
        .opp-meta-item i {
            color: var(--primary);
        }
        
        .success-rate {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .success-bar {
            width: 100px;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .success-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--danger), var(--warning), var(--secondary));
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .opp-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }
        
        /* Proposal Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--dark);
            border-radius: 16px;
            padding: 30px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 24px;
            cursor: pointer;
        }
        
        .proposal-text {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;
            white-space: pre-wrap;
            line-height: 1.8;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        /* Calculator Section */
        .calc-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .calc-result {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .calc-result-value {
            font-size: 36px;
            font-weight: 700;
        }
        
        .calc-result-label {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* BOQ Table */
        .boq-table {
            margin-top: 20px;
        }
        
        .boq-total {
            background: rgba(37, 99, 235, 0.2);
            font-weight: 700;
        }
        
        /* Finance Charts placeholder */
        .chart-placeholder {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.02);
            border-radius: 12px;
            color: var(--gray);
        }
        
        /* Marketing Content */
        .content-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .content-card h4 {
            margin-bottom: 10px;
        }
        
        .content-card p {
            color: var(--gray);
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        /* Last updated */
        .last-updated {
            text-align: center;
            padding: 20px;
            color: var(--gray);
            font-size: 12px;
        }
        
        /* Mobile responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(100%);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-right: 0;
            }
            
            .mobile-toggle {
                display: block !important;
            }
            
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .calc-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 101;
            background: var(--primary);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Mobile Toggle -->
    <button class="mobile-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-building"></i>
            </div>
            <div class="logo-text">
                <h2>QS Empire</h2>
                <span>Eng. Basel Omar</span>
            </div>
        </div>
        
        <nav>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link active" onclick="showPage('dashboard')">
                        <i class="fas fa-chart-line"></i>
                        <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('opportunities')">
                        <i class="fas fa-bullseye"></i>
                        <span>Ø§Ù„ÙØ±Øµ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('clients')">
                        <i class="fas fa-users"></i>
                        <span>Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('calculator')">
                        <i class="fas fa-calculator"></i>
                        <span>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙƒÙ…ÙŠØ§Øª</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('finance')">
                        <i class="fas fa-wallet"></i>
                        <span>Ø§Ù„Ù…Ø§Ù„ÙŠØ©</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage('marketing')">
                        <i class="fas fa-bullhorn"></i>
                        <span>Ø§Ù„ØªØ³ÙˆÙŠÙ‚</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <div class="page active" id="page-dashboard">
            <div class="header">
                <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙŠØ§ Ø¨Ø§Ø´Ù…Ù‡Ù†Ø¯Ø³ Ø¨Ø§Ø³Ù„ ğŸ‘‹</h1>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i>
                        ØªØ­Ø¯ÙŠØ«
                    </button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card animate-in">
                    <div class="stat-header">
                        <div class="stat-icon blue">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <span class="stat-change up">+12%</span>
                    </div>
                    <div class="stat-value" id="stat-opportunities">0</div>
                    <div class="stat-label">ÙØ±Øµ Ø¬Ø¯ÙŠØ¯Ø© Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
                </div>
                
                <div class="stat-card animate-in" style="animation-delay: 0.1s">
                    <div class="stat-header">
                        <div class="stat-icon green">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <span class="stat-change up">+5%</span>
                    </div>
                    <div class="stat-value" id="stat-won">0</div>
                    <div class="stat-label">Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…ÙƒØªØ³Ø¨Ø©</div>
                </div>
                
                <div class="stat-card animate-in" style="animation-delay: 0.2s">
                    <div class="stat-header">
                        <div class="stat-icon yellow">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="stat-clients">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
                </div>
                
                <div class="stat-card animate-in" style="animation-delay: 0.3s">
                    <div class="stat-header">
                        <div class="stat-icon green">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="stat-revenue">$0</div>
                    <div class="stat-label">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
                </div>
            </div>
            
            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ¯ Ø£Ø­Ø¯Ø« Ø§Ù„ÙØ±Øµ</h3>
                        <button class="btn btn-sm btn-secondary" onclick="showPage('opportunities')">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
                    </div>
                    <div id="recent-opportunities">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ‘¥ Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3>
                        <button class="btn btn-sm btn-secondary" onclick="showPage('clients')">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
                    </div>
                    <div id="recent-clients">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>
            </div>
            
            <div class="last-updated">
                Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„ÙØ±Øµ: <span id="last-updated">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
            </div>
        </div>
        
        <!-- Opportunities Page -->
        <div class="page" id="page-opportunities">
            <div class="header">
                <h1>ğŸ¯ Ø§Ù„ÙØ±Øµ Ø§Ù„Ù…ØªØ§Ø­Ø©</h1>
                <div class="header-actions">
                    <select class="form-control" style="width: auto;" onchange="filterOpportunities(this.value)">
                        <option value="all">ÙƒÙ„ Ø§Ù„Ù…Ù†ØµØ§Øª</option>
                        <option value="upwork">Upwork</option>
                        <option value="freelancer">Freelancer</option>
                        <option value="mostaql">Ù…Ø³ØªÙ‚Ù„</option>
                        <option value="fiverr">Fiverr</option>
                    </select>
                    <button class="btn btn-primary" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i>
                        ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙØ±Øµ
                    </button>
                </div>
            </div>
            
            <div id="opportunities-list">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
        
        <!-- Clients Page -->
        <div class="page" id="page-clients">
            <div class="header">
                <h1>ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h1>
                <button class="btn btn-primary" onclick="showAddClientModal()">
                    <i class="fas fa-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„
                </button>
            </div>
            
            <div class="card">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ø§Ø³Ù…</th>
                                <th>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</th>
                                <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
                                <th>Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</th>
                                <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="clients-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Calculator Page -->
        <div class="page" id="page-calculator">
            <div class="header">
                <h1>ğŸ§® Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙƒÙ…ÙŠØ§Øª</h1>
            </div>
            
            <div class="calc-grid">
                <div class="card">
                    <h3 class="card-title" style="margin-bottom: 20px;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ù†Ø¯</h3>
                    
                    <div class="form-group">
                        <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„</label>
                        <select class="form-control" id="calc-work-type" onchange="updateRate()">
                            <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„</option>
                            <option value="excavation" data-rate="45">Ø­ÙØ± (45 AED/mÂ³)</option>
                            <option value="concrete" data-rate="850">Ø®Ø±Ø³Ø§Ù†Ø© (850 AED/mÂ³)</option>
                            <option value="blockwork" data-rate="180">Ø¨Ù„ÙˆÙƒ (180 AED/mÂ²)</option>
                            <option value="plastering" data-rate="65">Ù„ÙŠØ§Ø³Ø© (65 AED/mÂ²)</option>
                            <option value="tiling" data-rate="120">Ø¨Ù„Ø§Ø· (120 AED/mÂ²)</option>
                            <option value="painting" data-rate="25">Ø¯Ù‡Ø§Ù† (25 AED/mÂ²)</option>
                            <option value="waterproofing" data-rate="85">Ø¹Ø²Ù„ Ù…Ø§Ø¦ÙŠ (85 AED/mÂ²)</option>
                            <option value="rebar" data-rate="4500">Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­ (4500 AED/ton)</option>
                        </select>
                    </div>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ø·ÙˆÙ„ (Ù…)</label>
                            <input type="number" class="form-control" id="calc-length" placeholder="0.00" oninput="calculateQuantity()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ø¹Ø±Ø¶ (Ù…)</label>
                            <input type="number" class="form-control" id="calc-width" placeholder="0.00" oninput="calculateQuantity()">
                        </div>
                    </div>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ø§Ø±ØªÙØ§Ø¹/Ø§Ù„Ø³Ù…Ùƒ (Ù…)</label>
                            <input type="number" class="form-control" id="calc-height" placeholder="0.00" oninput="calculateQuantity()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ø§Ù„Ø¹Ø¯Ø¯</label>
                            <input type="number" class="form-control" id="calc-qty" value="1" oninput="calculateQuantity()">
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%;" onclick="addToBOQ()">
                        <i class="fas fa-plus"></i>
                        Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø¬Ø¯ÙˆÙ„
                    </button>
                </div>
                
                <div class="card">
                    <h3 class="card-title" style="margin-bottom: 20px;">Ø§Ù„Ù†ØªÙŠØ¬Ø©</h3>
                    
                    <div class="calc-result" style="margin-bottom: 20px;">
                        <div class="calc-result-label">Ø§Ù„Ù…Ø³Ø§Ø­Ø©</div>
                        <div class="calc-result-value" id="calc-area">0.00 mÂ²</div>
                    </div>
                    
                    <div class="calc-result" style="margin-bottom: 20px; background: linear-gradient(135deg, var(--secondary), #059669);">
                        <div class="calc-result-label">Ø§Ù„Ø­Ø¬Ù…</div>
                        <div class="calc-result-value" id="calc-volume">0.00 mÂ³</div>
                    </div>
                    
                    <div class="calc-result" style="background: linear-gradient(135deg, var(--warning), #d97706);">
                        <div class="calc-result-label">Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</div>
                        <div class="calc-result-value" id="calc-cost">0.00 AED</div>
                    </div>
                </div>
            </div>
            
            <!-- BOQ Table -->
            <div class="card boq-table">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙƒÙ…ÙŠØ§Øª (BOQ)</h3>
                    <div>
                        <button class="btn btn-sm btn-secondary" onclick="clearBOQ()">
                            <i class="fas fa-trash"></i>
                            Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                        </button>
                        <button class="btn btn-sm btn-success" onclick="exportBOQ()">
                            <i class="fas fa-file-excel"></i>
                            ØªØµØ¯ÙŠØ± Excel
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ù„Ø¨Ù†Ø¯</th>
                                <th>Ø§Ù„ÙˆØ­Ø¯Ø©</th>
                                <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                                <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="boq-table">
                        </tbody>
                        <tfoot>
                            <tr class="boq-total">
                                <td colspan="5" style="text-align: left;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</td>
                                <td id="boq-total">0.00 AED</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td colspan="5" style="text-align: left;">Ø§Ø­ØªÙŠØ§Ø·ÙŠ (10%)</td>
                                <td id="boq-contingency">0.00 AED</td>
                                <td></td>
                            </tr>
                            <tr class="boq-total">
                                <td colspan="5" style="text-align: left;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ</td>
                                <td id="boq-grand-total">0.00 AED</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Finance Page -->
        <div class="page" id="page-finance">
            <div class="header">
                <h1>ğŸ’° Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h1>
                <button class="btn btn-primary" onclick="showAddTransactionModal()">
                    <i class="fas fa-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©
                </button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon green">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="total-income">$0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon red">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="total-expenses">$0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon blue">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="net-balance">$0</div>
                    <div class="stat-label">ØµØ§ÙÙŠ Ø§Ù„Ø±ØµÙŠØ¯</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©</h3>
                    <button class="btn btn-sm btn-secondary" onclick="exportFinance()">
                        <i class="fas fa-download"></i>
                        ØªØµØ¯ÙŠØ±
                    </button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„ÙˆØµÙ</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="transactions-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Marketing Page -->
        <div class="page" id="page-marketing">
            <div class="header">
                <h1>ğŸ“¢ Ø§Ù„ØªØ³ÙˆÙŠÙ‚</h1>
            </div>
            
            <div class="card">
                <h3 class="card-title" style="margin-bottom: 20px;">ğŸ¯ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h3>
                <div class="grid-3">
                    <div class="content-card">
                        <h4>ğŸ† +10 Ø³Ù†ÙˆØ§Øª Ø®Ø¨Ø±Ø©</h4>
                        <p>Ø®Ø¨Ø±Ø© ÙˆØ§Ø³Ø¹Ø© ÙÙŠ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„ØªØ´ÙŠÙŠØ¯ ÙÙŠ Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</p>
                    </div>
                    <div class="content-card">
                        <h4>ğŸ“Š +300 Ù…Ø´Ø±ÙˆØ¹</h4>
                        <p>Ø³Ø¬Ù„ Ø­Ø§ÙÙ„ Ù…Ù† Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ù†Ø§Ø¬Ø­Ø© ÙÙŠ Ù…Ø®ØªÙ„Ù Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª</p>
                    </div>
                    <div class="content-card">
                        <h4>âœ… Ù…Ø¹ØªÙ…Ø¯ G+4</h4>
                        <p>Ø§Ø¹ØªÙ…Ø§Ø¯ Ù…Ù† Ø¨Ù„Ø¯ÙŠØ© Ø¯Ø¨ÙŠ Ù„Ù„Ù…Ø¨Ø§Ù†ÙŠ Ø­ØªÙ‰ G+4</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“ Ù…Ø­ØªÙˆÙ‰ Ø¬Ø§Ù‡Ø² Ù„Ù„Ù†Ø´Ø±</h3>
                </div>
                
                <div class="content-card">
                    <h4>LinkedIn Post</h4>
                    <p id="linkedin-content">ğŸ—ï¸ Looking for accurate Quantity Surveying services in UAE?

With 10+ years of experience and 300+ completed projects, I provide:
âœ… Precise BOQ preparation
âœ… Cost estimation
âœ… Dubai Municipality approved (G+4)

Let's discuss your project!

#QuantitySurveyor #UAE #Construction #BOQ #CostEstimation</p>
                    <button class="btn btn-sm btn-secondary" onclick="copyContent('linkedin-content')">
                        <i class="fas fa-copy"></i>
                        Ù†Ø³Ø®
                    </button>
                </div>
                
                <div class="content-card">
                    <h4>Upwork Profile Summary</h4>
                    <p id="upwork-content">Professional Quantity Surveyor with 10+ years of experience in the UAE construction industry.

ğŸ† EXPERTISE:
â€¢ Bill of Quantities (BOQ) preparation
â€¢ Cost estimation & analysis
â€¢ Tender documentation
â€¢ Variation orders & final accounts
â€¢ Dubai Municipality submissions (G+4 approved)

ğŸ“Š TRACK RECORD:
â€¢ 300+ completed projects
â€¢ Residential, commercial & infrastructure
â€¢ Consistent 5-star reviews

ğŸ’¡ I deliver accurate, detailed, and timely quantity surveying services that help you manage costs and make informed decisions.

Let's work together on your next project!</p>
                    <button class="btn btn-sm btn-secondary" onclick="copyContent('upwork-content')">
                        <i class="fas fa-copy"></i>
                        Ù†Ø³Ø®
                    </button>
                </div>
                
                <div class="content-card">
                    <h4>Proposal Template</h4>
                    <p id="proposal-template">Dear [Client Name],

Thank you for considering me for your [Project Type] project.

I am a Quantity Surveyor with over 10 years of experience in the UAE, having successfully completed 300+ projects including residential villas, commercial buildings, and infrastructure works.

For your project, I will provide:
1. Detailed quantity takeoff from drawings
2. Accurate BOQ preparation
3. Market-rate cost estimation
4. Professional documentation ready for tendering

Timeline: [X] days
Investment: [$$]

I am Dubai Municipality approved (G+4) and committed to delivering precise, reliable work.

Looking forward to working with you.

Best regards,
Eng. Basel Omar
Quantity Surveyor</p>
                    <button class="btn btn-sm btn-secondary" onclick="copyContent('proposal-template')">
                        <i class="fas fa-copy"></i>
                        Ù†Ø³Ø®
                    </button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Proposal Modal -->
    <div class="modal" id="proposalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“ Proposal Ø¬Ø§Ù‡Ø²</h3>
                <button class="modal-close" onclick="closeModal('proposalModal')">&times;</button>
            </div>
            <div class="proposal-text" id="proposal-content"></div>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn btn-primary" onclick="copyProposal()">
                    <i class="fas fa-copy"></i>
                    Ù†Ø³Ø® Ø§Ù„Ù€ Proposal
                </button>
                <button class="btn btn-secondary" onclick="closeModal('proposalModal')">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>
    
    <!-- Add Client Modal -->
    <div class="modal" id="addClientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="modal-close" onclick="closeModal('addClientModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                <input type="text" class="form-control" id="client-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
            </div>
            <div class="form-group">
                <label class="form-label">Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</label>
                <input type="email" class="form-control" id="client-email" placeholder="email@example.com">
            </div>
            <div class="form-group">
                <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <input type="tel" class="form-control" id="client-phone" placeholder="+971 XX XXX XXXX">
            </div>
            <div class="form-group">
                <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                <textarea class="form-control" id="client-notes" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="addClient()">
                <i class="fas fa-save"></i>
                Ø­ÙØ¸ Ø§Ù„Ø¹Ù…ÙŠÙ„
            </button>
        </div>
    </div>
    
    <!-- Add Transaction Modal -->
    <div class="modal" id="addTransactionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>â• Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø©</h3>
                <button class="modal-close" onclick="closeModal('addTransactionModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Ø§Ù„Ù†ÙˆØ¹</label>
                <select class="form-control" id="trans-type">
                    <option value="income">Ø¯Ø®Ù„</option>
                    <option value="expense">Ù…ØµØ±ÙˆÙ</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Ø§Ù„ÙˆØµÙ</label>
                <input type="text" class="form-control" id="trans-desc" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©">
            </div>
            <div class="form-group">
                <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº ($)</label>
                <input type="number" class="form-control" id="trans-amount" placeholder="0.00">
            </div>
            <div class="form-group">
                <label class="form-label">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                <input type="date" class="form-control" id="trans-date">
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="addTransaction()">
                <i class="fas fa-save"></i>
                Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©
            </button>
        </div>
    </div>

    <script>
        // Data Storage
        let appData = {
            opportunities: [],
            clients: [],
            transactions: [],
            boqItems: [],
            lastUpdated: null
        };
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            document.getElementById('trans-date').valueAsDate = new Date();
        });
        
        // Load data from JSON file or localStorage
        async function loadData() {
            try {
                // Try to fetch from data.json (updated by Tasklet)
                const response = await fetch('data.json?t=' + Date.now());
                if (response.ok) {
                    const serverData = await response.json();
                    appData.opportunities = serverData.opportunities || [];
                    appData.lastUpdated = serverData.lastUpdated;
                }
            } catch (e) {
                console.log('Using local data');
            }
            
            // Load local data (clients, transactions, boq)
            const localData = localStorage.getItem('qsEmpireData');
            if (localData) {
                const parsed = JSON.parse(localData);
                appData.clients = parsed.clients || [];
                appData.transactions = parsed.transactions || [];
                appData.boqItems = parsed.boqItems || [];
            }
            
            renderAll();
        }
        
        // Save local data
        function saveLocalData() {
            localStorage.setItem('qsEmpireData', JSON.stringify({
                clients: appData.clients,
                transactions: appData.transactions,
                boqItems: appData.boqItems
            }));
        }
        
        // Render all components
        function renderAll() {
            renderStats();
            renderOpportunities();
            renderRecentOpportunities();
            renderClients();
            renderRecentClients();
            renderTransactions();
            renderBOQ();
            
            if (appData.lastUpdated) {
                document.getElementById('last-updated').textContent = new Date(appData.lastUpdated).toLocaleString('ar-EG');
            }
        }
        
        // Navigation
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
            
            document.getElementById('page-' + pageName).classList.add('active');
            event.target.closest('.nav-link').classList.add('active');
            
            // Close sidebar on mobile
            document.getElementById('sidebar').classList.remove('open');
        }
        
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }
        
        // Render Stats
        function renderStats() {
            document.getElementById('stat-opportunities').textContent = appData.opportunities.length;
            document.getElementById('stat-won').textContent = appData.opportunities.filter(o => o.status === 'won').length;
            document.getElementById('stat-clients').textContent = appData.clients.length;
            
            const totalIncome = appData.transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
            document.getElementById('stat-revenue').textContent = '$' + totalIncome.toLocaleString();
        }
        
        // Render Opportunities
        function renderOpportunities(filter = 'all') {
            const container = document.getElementById('opportunities-list');
            let opps = appData.opportunities;
            
            if (filter !== 'all') {
                opps = opps.filter(o => o.platform.toLowerCase().includes(filter));
            }
            
            if (opps.length === 0) {
                container.innerHTML = '<div class="content-card"><p style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ±Øµ Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹. Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...</p></div>';
                return;
            }
            
            container.innerHTML = opps.map(opp => `
                <div class="opp-card">
                    <div class="opp-header">
                        <div>
                            <div class="opp-title">${opp.title}</div>
                            <div class="opp-platform">${opp.platform}</div>
                        </div>
                        <span class="badge badge-${opp.status || 'new'}">${getStatusArabic(opp.status || 'new')}</span>
                    </div>
                    <div class="opp-meta">
                        <div class="opp-meta-item">
                            <i class="fas fa-dollar-sign"></i>
                            ${opp.budget || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                        </div>
                        <div class="opp-meta-item">
                            <i class="fas fa-clock"></i>
                            ${opp.date || 'Ø§Ù„ÙŠÙˆÙ…'}
                        </div>
                        <div class="opp-meta-item success-rate">
                            <span>Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­:</span>
                            <div class="success-bar">
                                <div class="success-fill" style="width: ${opp.successRate || 70}%"></div>
                            </div>
                            <span>${opp.successRate || 70}%</span>
                        </div>
                    </div>
                    <div class="opp-actions">
                        <a href="${opp.url}" target="_blank" class="btn btn-sm btn-primary">
                            <i class="fas fa-external-link-alt"></i>
                            ÙØªØ­ Ø§Ù„ÙØ±ØµØ©
                        </a>
                        <button class="btn btn-sm btn-success" onclick="showProposal('${opp.id}')">
                            <i class="fas fa-file-alt"></i>
                            Ø¹Ø±Ø¶ Ø§Ù„Ù€ Proposal
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function filterOpportunities(value) {
            renderOpportunities(value);
        }
        
        function renderRecentOpportunities() {
            const container = document.getElementById('recent-opportunities');
            const recent = appData.opportunities.slice(0, 3);
            
            if (recent.length === 0) {
                container.innerHTML = '<p style="color: var(--gray); text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ±Øµ Ø¨Ø¹Ø¯</p>';
                return;
            }
            
            container.innerHTML = recent.map(opp => `
                <div class="opp-card" style="margin-bottom: 10px;">
                    <div class="opp-title">${opp.title}</div>
                    <div class="opp-platform">${opp.platform} - ${opp.budget || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                </div>
            `).join('');
        }
        
        // Proposals
        function showProposal(oppId) {
            const opp = appData.opportunities.find(o => o.id === oppId);
            if (!opp) return;
            
            const proposal = opp.proposal || generateProposal(opp);
            document.getElementById('proposal-content').textContent = proposal;
            document.getElementById('proposalModal').classList.add('active');
        }
        
        function generateProposal(opp) {
            return `Dear Hiring Manager,

I am writing to express my strong interest in your ${opp.title} project.

As a Quantity Surveyor with over 10 years of experience in the UAE construction industry and 300+ successfully completed projects, I am confident in my ability to deliver exceptional results for your project.

MY QUALIFICATIONS:
âœ“ Dubai Municipality approved (G+4)
âœ“ Expert in BOQ preparation, cost estimation, and quantity takeoff
âœ“ Proficient in AutoCAD, Bluebeam, and Excel
âœ“ Strong track record of accurate and timely deliverables

WHAT I OFFER:
â€¢ Detailed and precise quantity takeoff
â€¢ Market-competitive cost estimation
â€¢ Professional documentation
â€¢ Clear communication throughout the project

I am available to start immediately and committed to delivering high-quality work within your timeline.

Looking forward to discussing your project requirements.

Best regards,
Eng. Basel Omar
Quantity Surveyor | UAE`;
        }
        
        function copyProposal() {
            const text = document.getElementById('proposal-content').textContent;
            navigator.clipboard.writeText(text);
            alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù€ Proposal! âœ…');
        }
        
        // Clients
        function renderClients() {
            const tbody = document.getElementById('clients-table');
            
            if (appData.clients.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: var(--gray);">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø¹Ø¯</td></tr>';
                return;
            }
            
            tbody.innerHTML = appData.clients.map((client, index) => `
                <tr>
                    <td>${client.name}</td>
                    <td>${client.email || '-'}</td>
                    <td>${client.phone || '-'}</td>
                    <td>${client.projects || 0}</td>
                    <td>$${(client.totalPaid || 0).toLocaleString()}</td>
                    <td>
                        <button class="btn btn-sm btn-secondary" onclick="deleteClient(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }
        
        function renderRecentClients() {
            const container = document.getElementById('recent-clients');
            const recent = appData.clients.slice(0, 3);
            
            if (recent.length === 0) {
                container.innerHTML = '<p style="color: var(--gray); text-align: center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø¹Ø¯</p>';
                return;
            }
            
            container.innerHTML = recent.map(client => `
                <div class="opp-card" style="margin-bottom: 10px;">
                    <div class="opp-title">${client.name}</div>
                    <div class="opp-platform">${client.email || client.phone || 'Ø¨Ø¯ÙˆÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§ØªØµØ§Ù„'}</div>
                </div>
            `).join('');
        }
        
        function showAddClientModal() {
            document.getElementById('addClientModal').classList.add('active');
        }
        
        function addClient() {
            const name = document.getElementById('client-name').value;
            const email = document.getElementById('client-email').value;
            const phone = document.getElementById('client-phone').value;
            const notes = document.getElementById('client-notes').value;
            
            if (!name) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„');
                return;
            }
            
            appData.clients.push({
                id: Date.now(),
                name,
                email,
                phone,
                notes,
                projects: 0,
                totalPaid: 0,
                createdAt: new Date().toISOString()
            });
            
            saveLocalData();
            renderAll();
            closeModal('addClientModal');
            
            // Clear form
            document.getElementById('client-name').value = '';
            document.getElementById('client-email').value = '';
            document.getElementById('client-phone').value = '';
            document.getElementById('client-notes').value = '';
        }
        
        function deleteClient(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŸ')) {
                appData.clients.splice(index, 1);
                saveLocalData();
                renderAll();
            }
        }
        
        // Calculator
        let currentRate = 0;
        
        function updateRate() {
            const select = document.getElementById('calc-work-type');
            currentRate = parseFloat(select.options[select.selectedIndex].dataset.rate) || 0;
            calculateQuantity();
        }
        
        function calculateQuantity() {
            const length = parseFloat(document.getElementById('calc-length').value) || 0;
            const width = parseFloat(document.getElementById('calc-width').value) || 0;
            const height = parseFloat(document.getElementById('calc-height').value) || 0;
            const qty = parseFloat(document.getElementById('calc-qty').value) || 1;
            
            const area = length * width * qty;
            const volume = length * width * height * qty;
            const cost = (height > 0 ? volume : area) * currentRate;
            
            document.getElementById('calc-area').textContent = area.toFixed(2) + ' mÂ²';
            document.getElementById('calc-volume').textContent = volume.toFixed(2) + ' mÂ³';
            document.getElementById('calc-cost').textContent = cost.toFixed(2) + ' AED';
        }
        
        function addToBOQ() {
            const select = document.getElementById('calc-work-type');
            const workType = select.options[select.selectedIndex].text;
            
            if (!workType || select.value === '') {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„');
                return;
            }
            
            const length = parseFloat(document.getElementById('calc-length').value) || 0;
            const width = parseFloat(document.getElementById('calc-width').value) || 0;
            const height = parseFloat(document.getElementById('calc-height').value) || 0;
            const qty = parseFloat(document.getElementById('calc-qty').value) || 1;
            
            const isVolume = height > 0;
            const quantity = isVolume ? (length * width * height * qty) : (length * width * qty);
            const unit = isVolume ? 'mÂ³' : 'mÂ²';
            const total = quantity * currentRate;
            
            appData.boqItems.push({
                id: Date.now(),
                description: workType,
                unit: unit,
                quantity: quantity.toFixed(2),
                rate: currentRate,
                total: total.toFixed(2)
            });
            
            saveLocalData();
            renderBOQ();
            
            // Clear inputs
            document.getElementById('calc-length').value = '';
            document.getElementById('calc-width').value = '';
            document.getElementById('calc-height').value = '';
            document.getElementById('calc-qty').value = '1';
            calculateQuantity();
        }
        
        function renderBOQ() {
            const tbody = document.getElementById('boq-table');
            
            if (appData.boqItems.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: var(--gray);">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ù†ÙˆØ¯ Ø¨Ø¹Ø¯</td></tr>';
                document.getElementById('boq-total').textContent = '0.00 AED';
                document.getElementById('boq-contingency').textContent = '0.00 AED';
                document.getElementById('boq-grand-total').textContent = '0.00 AED';
                return;
            }
            
            tbody.innerHTML = appData.boqItems.map((item, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${item.description}</td>
                    <td>${item.unit}</td>
                    <td>${item.quantity}</td>
                    <td>${item.rate} AED</td>
                    <td>${item.total} AED</td>
                    <td>
                        <button class="btn btn-sm btn-secondary" onclick="deleteBOQItem(${index})">
                            <i class="fas fa-times"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            const total = appData.boqItems.reduce((sum, item) => sum + parseFloat(item.total), 0);
            const contingency = total * 0.1;
            const grandTotal = total + contingency;
            
            document.getElementById('boq-total').textContent = total.toFixed(2) + ' AED';
            document.getElementById('boq-contingency').textContent = contingency.toFixed(2) + ' AED';
            document.getElementById('boq-grand-total').textContent = grandTotal.toFixed(2) + ' AED';
        }
        
        function deleteBOQItem(index) {
            appData.boqItems.splice(index, 1);
            saveLocalData();
            renderBOQ();
        }
        
        function clearBOQ() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨Ù†ÙˆØ¯ØŸ')) {
                appData.boqItems = [];
                saveLocalData();
                renderBOQ();
            }
        }
        
        function exportBOQ() {
            let csv = 'Ø§Ù„Ø±Ù‚Ù…,Ø§Ù„Ø¨Ù†Ø¯,Ø§Ù„ÙˆØ­Ø¯Ø©,Ø§Ù„ÙƒÙ…ÙŠØ©,Ø§Ù„Ø³Ø¹Ø±,Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ\n';
            appData.boqItems.forEach((item, index) => {
                csv += `${index + 1},${item.description},${item.unit},${item.quantity},${item.rate},${item.total}\n`;
            });
            
            const total = appData.boqItems.reduce((sum, item) => sum + parseFloat(item.total), 0);
            csv += `\n,,,,Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ,${total.toFixed(2)}\n`;
            csv += `,,,,Ø§Ø­ØªÙŠØ§Ø·ÙŠ 10%,${(total * 0.1).toFixed(2)}\n`;
            csv += `,,,,Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ,${(total * 1.1).toFixed(2)}\n`;
            
            downloadFile(csv, 'BOQ_Basel_Omar.csv', 'text/csv');
        }
        
        // Finance
        function renderTransactions() {
            const tbody = document.getElementById('transactions-table');
            
            if (appData.transactions.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: var(--gray);">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¨Ø¹Ø¯</td></tr>';
                return;
            }
            
            tbody.innerHTML = appData.transactions.map((trans, index) => `
                <tr>
                    <td>${new Date(trans.date).toLocaleDateString('ar-EG')}</td>
                    <td>${trans.description}</td>
                    <td><span class="badge badge-${trans.type === 'income' ? 'won' : 'lost'}">${trans.type === 'income' ? 'Ø¯Ø®Ù„' : 'Ù…ØµØ±ÙˆÙ'}</span></td>
                    <td style="color: ${trans.type === 'income' ? 'var(--secondary)' : 'var(--danger)'}">
                        ${trans.type === 'income' ? '+' : '-'}$${trans.amount.toLocaleString()}
                    </td>
                    <td>
                        <button class="btn btn-sm btn-secondary" onclick="deleteTransaction(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
            
            // Update totals
            const income = appData.transactions.filter(t => t.type === 'income').reduce((s, t) => s + t.amount, 0);
            const expenses = appData.transactions.filter(t => t.type === 'expense').reduce((s, t) => s + t.amount, 0);
            const balance = income - expenses;
            
            document.getElementById('total-income').textContent = '$' + income.toLocaleString();
            document.getElementById('total-expenses').textContent = '$' + expenses.toLocaleString();
            document.getElementById('net-balance').textContent = '$' + balance.toLocaleString();
            document.getElementById('net-balance').style.color = balance >= 0 ? 'var(--secondary)' : 'var(--danger)';
        }
        
        function showAddTransactionModal() {
            document.getElementById('addTransactionModal').classList.add('active');
        }
        
        function addTransaction() {
            const type = document.getElementById('trans-type').value;
            const description = document.getElementById('trans-desc').value;
            const amount = parseFloat(document.getElementById('trans-amount').value);
            const date = document.getElementById('trans-date').value;
            
            if (!description || !amount || !date) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }
            
            appData.transactions.unshift({
                id: Date.now(),
                type,
                description,
                amount,
                date
            });
            
            saveLocalData();
            renderAll();
            closeModal('addTransactionModal');
            
            // Clear form
            document.getElementById('trans-desc').value = '';
            document.getElementById('trans-amount').value = '';
        }
        
        function deleteTransaction(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©ØŸ')) {
                appData.transactions.splice(index, 1);
                saveLocalData();
                renderAll();
            }
        }
        
        function exportFinance() {
            let csv = 'Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ù„ÙˆØµÙ,Ø§Ù„Ù†ÙˆØ¹,Ø§Ù„Ù…Ø¨Ù„Øº\n';
            appData.transactions.forEach(trans => {
                csv += `${trans.date},${trans.description},${trans.type === 'income' ? 'Ø¯Ø®Ù„' : 'Ù…ØµØ±ÙˆÙ'},${trans.amount}\n`;
            });
            downloadFile(csv, 'Finance_Basel_Omar.csv', 'text/csv');
        }
        
        // Marketing
        function copyContent(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text);
            alert('ØªÙ… Ø§Ù„Ù†Ø³Ø®! âœ…');
        }
        
        // Utilities
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        function getStatusArabic(status) {
            const statuses = {
                'new': 'Ø¬Ø¯ÙŠØ¯',
                'pending': 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                'won': 'Ù…ÙƒØªØ³Ø¨',
                'lost': 'Ø®Ø³Ø§Ø±Ø©'
            };
            return statuses[status] || status;
        }
        
        function downloadFile(content, filename, type) {
            const blob = new Blob([content], { type: type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        async function refreshData() {
            document.getElementById('recent-opportunities').innerHTML = '<div class="loading"><div class="spinner"></div></div>';
            await loadData();
            alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª! âœ…');
        }
        
        // Close modals on outside click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
